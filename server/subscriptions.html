<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-server docs-version-0.25 docs-doc-page docs-doc-id-subscriptions" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.8.1"><title data-rh=true>Subscriptions | Ariadne · Python GraphQL Schema-first</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://ariadnegraphql.org/img/docusaurus-social-card.jpg><meta data-rh=true name=twitter:image content=https://ariadnegraphql.org/img/docusaurus-social-card.jpg><meta data-rh=true property=og:url content=https://ariadnegraphql.org/server/subscriptions><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=0.25><meta data-rh=true name=docusaurus_tag content=docs-server-0.25><meta data-rh=true name=docsearch:version content=0.25><meta data-rh=true name=docsearch:docusaurus_tag content=docs-server-0.25><meta data-rh=true property=og:title content="Subscriptions | Ariadne · Python GraphQL Schema-first"><meta data-rh=true name=description content="Let's introduce a third type of operation. While queries offer a way to query a server once, subscriptions offer a way for the server to notify the client each time new data is available."><meta data-rh=true property=og:description content="Let's introduce a third type of operation. While queries offer a way to query a server once, subscriptions offer a way for the server to notify the client each time new data is available."><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://ariadnegraphql.org/server/subscriptions><link data-rh=true rel=alternate href=https://ariadnegraphql.org/server/subscriptions hreflang=en><link data-rh=true rel=alternate href=https://ariadnegraphql.org/server/subscriptions hreflang=x-default><link data-rh=true rel=preconnect href=https://BYJBYPP90Q-dsn.algolia.net crossorigin=anonymous><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://ariadnegraphql.org/server/subscriptions","name":"Subscriptions","position":1}]}</script><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="Ariadne · Python GraphQL Schema-first RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="Ariadne · Python GraphQL Schema-first Atom Feed"><link rel=search type=application/opensearchdescription+xml title="Ariadne · Python GraphQL Schema-first" href=/opensearch.xml><link rel=stylesheet href=/assets/css/styles.8871cce7.css><script src=/assets/js/runtime~main.e76e9168.js defer></script><script src=/assets/js/main.4899d341.js defer></script><body class=navigation-with-keyboard><svg xmlns=http://www.w3.org/2000/svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light",e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/img/logo-horizontal-sm.png><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/logo-horizontal-sm.png alt="Ariadne Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/logo-horizontal-sm.png alt="Ariadne Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/server/intro>Server Docs</a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/server/subscriptions>0.25</a><ul class=dropdown__menu><li><a class=dropdown__link href=/server/next/subscriptions>Next</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/server/subscriptions>0.25</a><li><a class=dropdown__link href=/server/0.24/subscriptions>0.24</a><li><a class=dropdown__link href=/server/0.23/subscriptions>0.23</a><li><a class=dropdown__link href=/server/0.22/subscriptions>0.22</a><li><a class=dropdown__link href=/server/0.21/subscriptions>0.21</a><li><a class=dropdown__link href=/server/0.20/subscriptions>0.20</a><li><a class=dropdown__link href=/server/0.19/subscriptions>0.19</a><li><a class=dropdown__link href=/server/0.18/subscriptions>0.18</a><li><a class=dropdown__link href=/server/0.17/subscriptions>0.17</a><li><a class=dropdown__link href=/server/0.16/subscriptions>0.16</a><li><a class=dropdown__link href=/server/0.15/subscriptions>0.15</a><li><a class=dropdown__link href=/server/0.14.0/subscriptions>0.14.0</a><li><a class=dropdown__link href=/server/0.13.0/subscriptions>0.13.0</a><li><a class=dropdown__link href=/server/0.12.0/subscriptions>0.12.0</a><li><a class=dropdown__link href=/server/0.11.0/subscriptions>0.11.0</a><li><a class=dropdown__link href=/server/0.10.0/subscriptions>0.10.0</a><li><a class=dropdown__link href=/server/0.9.0/subscriptions>0.9.0</a><li><a class=dropdown__link href=/server/0.8.0/subscriptions>0.8.0</a><li><a class=dropdown__link href=/server/0.7.0/subscriptions>0.7.0</a><li><a class=dropdown__link href=/server/0.6.0/subscriptions>0.6.0</a><li><a class=dropdown__link href=/server/0.5.0/subscriptions>0.5.0</a><li><a class=dropdown__link href=/server/0.4.0/subscriptions>0.4.0</a></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href=/blog>Blog</a><a class="navbar__item navbar__link" href=/community>Community</a><a href="https://github.com/mirumee/Ariadne?tab=readme-ov-file#ariadne-ecosystem" target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/server/intro>Docs</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/intro>Introduction</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/resolvers>Resolvers</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/mutations>Mutations</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/inputs>Inputs</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/error-messaging>Error messaging</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/case-conversion>Name case conversion</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/fragments>Fragments</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/scalars>Custom scalars</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/enums>Enumeration types</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/unions>Union types</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/interfaces>Interface types</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/server/subscriptions>Subscriptions</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/dataloaders>Dataloaders</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/file-uploads>File uploads</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/documenting-schema>Documenting schema</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/modularization>Modularization</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/bindables>Bindables</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/schema-directives>Schema directives</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/local-development>Local development</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/logging>Logging</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/explorers>GraphQL explorers</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/apollo-federation>Apollo Federation</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/open-telemetry>Monitoring</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/security-overview>Security</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/asgi>Servers</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/django-integration>Integrations</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/extensions>Extensions</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/api-reference>API reference</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/logo>Other</a></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Docs</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Subscriptions</span></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 0.25</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Subscriptions</h1></header><p>Let's introduce a third type of operation. While queries offer a way to query a server once, subscriptions offer a way for the server to notify the client each time new data is available.</p>
<p>This is where the <code>Subscription</code> type is useful. It's similar to <code>Query</code> but as each subscription remains an open channel you can send anywhere from zero to millions of responses over its lifetime.</p>
<blockquote>
<p>Because of their nature, subscriptions are only possible to implement in asynchronous servers that implement the WebSockets protocol.
(If you are using <code>uvicorn</code> you need to <code>pip install websockets</code> otherwise you'll get <code>Could not connect to websocket endpoint ws://localhost:8000/. Please check if the endpoint url is correct.</code>)</p>
<p><em>WSGI</em>-based servers (including Django) are synchronous in nature and <em>unable</em> to handle WebSockets which makes them incapable of implementing subscriptions.</p>
<p>If you wish to use subscriptions with Django, consider wrapping your Django application in a Django Channels container and using Ariadne as an <em>ASGI</em> server.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=subscription-protocols>Subscription protocols<a href=#subscription-protocols class=hash-link aria-label="Direct link to Subscription protocols" title="Direct link to Subscription protocols">​</a></h2>
<p>In the world of GraphQL clients, there are two subscription protocols that clients can implement for subscribing to GraphQL server.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=subscriptions-transport-ws><code>subscriptions-transport-ws</code><a href=#subscriptions-transport-ws class=hash-link aria-label="Direct link to subscriptions-transport-ws" title="Direct link to subscriptions-transport-ws">​</a></h3>
<p>Default protocol used by Ariadne. Client library for it is still widely used although no it's no longer maintained. It has benefit of being supported by GraphQL-Playground out of the box.</p>
<p>Repo link: <a href=https://github.com/apollographql/subscriptions-transport-ws target=_blank rel="noopener noreferrer">apollographql/subscriptions-transport-ws</a></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">asgi </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> GraphQL</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">asgi</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">handlers </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> GraphQLWSHandler</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">graphql_app </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> GraphQL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    schema</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    websocket_handler</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">GraphQLWSHandler</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=graphql-ws><code>graphql-ws</code><a href=#graphql-ws class=hash-link aria-label="Direct link to graphql-ws" title="Direct link to graphql-ws">​</a></h3>
<p>New protocol that replaced <code>subscriptions-transport-ws</code>. Its actively maintained and supported by Apollo Studio Explorer.</p>
<p>Repo link: <a href=https://github.com/enisdenjo/graphql-ws target=_blank rel="noopener noreferrer">enisdenjo/graphql-ws</a></p>
<p>To make Ariadne use <code>graphql-ws</code> protocol for subscriptions, initialize <code>ariadne.asgi.GraphQL</code> app with <code>ariadne.asgi.handlers.GraphQLTransportWSHandler</code> instance:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">asgi </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> GraphQL</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">asgi</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">handlers </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> GraphQLTransportWSHandler</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">graphql_app </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> GraphQL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    schema</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    websocket_handler</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">GraphQLTransportWSHandler</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Note:</strong> Name of class implementing <code>graphql-ws</code> is not a mistake. The subprotocol used for subscriptions is indeed named <a href=https://github.com/enisdenjo/graphql-ws/blob/master/PROTOCOL.md target=_blank rel="noopener noreferrer"><code>graphql-transport-ws</code></a>.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=defining-subscriptions>Defining subscriptions<a href=#defining-subscriptions class=hash-link aria-label="Direct link to Defining subscriptions" title="Direct link to Defining subscriptions">​</a></h2>
<p>In schema definition subscriptions look similar to queries:</p>
<div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-graphql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>type</span><span class="token plain"> </span><span class="token class-name">Query</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token attr-name" style=color:#00a4db>_unused</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token scalar">Boolean</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>type</span><span class="token plain"> </span><span class="token class-name">Subscription</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token attr-name" style=color:#00a4db>counter</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token scalar">Int</span><span class="token operator" style=color:#393A34>!</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<p>This example contains:</p>
<ul>
<li><code>Query</code> type with single unused field. GraphQL considers an empty type a syntax error and requires an API to always define a <code>Query</code> type.<!-- -->
<ul>
<li>For this example, we're focusing on <code>Subscription</code>s so we define a bare bones <code>Query</code> type.</li>
</ul>
</li>
<li><code>Subscription</code> type with a single field, <code>counter</code>, that returns a number.</li>
</ul>
<p>When defining subscriptions you can use all of the features of the schema such as arguments, input and output types.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=writing-subscriptions>Writing subscriptions<a href=#writing-subscriptions class=hash-link aria-label="Direct link to Writing subscriptions" title="Direct link to Writing subscriptions">​</a></h2>
<p>Subscriptions are more complex than queries as they require us to provide two functions for each field:</p>
<ul>
<li><code>generator</code> is a function that yields data we're going to send to the client. It has to implement the <code>AsyncGenerator</code> protocol.</li>
<li><code>resolver</code> that tells the server how to send data to the client. This is similar to the <a href=/server/resolvers>resolvers we wrote earlier</a>.</li>
</ul>
<blockquote>
<p>Make sure you understand how asynchronous generators work before attempting to use subscriptions.</p>
</blockquote>
<p>The signatures are as follows:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>counter_generator</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">obj</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> info</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> i </span><span class="token keyword" style=color:#00009f>in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>5</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> asyncio</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">sleep</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>yield</span><span class="token plain"> i</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>counter_resolver</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">count</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> info</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> count </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><br></span></code></pre></div></div>
<p>Note that the resolver consumes the same type (in this case <code>int</code>) that the generator yields.</p>
<p>Each time our source yields a response, it's getting sent to our resolver. The above implementation counts from zero to four, each time waiting for one second before yielding a value.</p>
<p>The resolver increases each number by one before passing them to the client so the client sees the counter progress from one to five.</p>
<p>After the last value is yielded the generator returns, the server tells the client that no more data will be available, and the subscription is complete.</p>
<p>We can map these functions to subscription fields using the <code>SubscriptionType</code> class that extends <code>ObjectType</code> with support for <code>source</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> SubscriptionType</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> counter_subscriptions</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">subscription </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> SubscriptionType</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">subscription</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">set_field</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"counter"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> counter_subscriptions</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">counter_resolver</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">subscription</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">set_source</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"counter"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> counter_subscriptions</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">counter_generator</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<p>You can also use the <code>source</code> decorator:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token decorator annotation punctuation" style=color:#393A34>@subscription</span><span class="token decorator annotation punctuation" style=color:#393A34>.</span><span class="token decorator annotation punctuation" style=color:#393A34>source</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"counter"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>counter_generator</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    obj</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> info</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> GraphQLResolveInfo</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token operator" style=color:#393A34>></span><span class="token plain"> AsyncGenerator</span><span class="token punctuation" style=color:#393A34>[</span><span class="token builtin">int</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>None</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=publisher-consumer>Publisher-consumer<a href=#publisher-consumer class=hash-link aria-label="Direct link to Publisher-consumer" title="Direct link to Publisher-consumer">​</a></h2>
<p>Pubisher-consumer ("pub-sub") is a pattern in which parts of the system listen for ("subscribe to") events ("messages") from other parts of the system, usually reacting to them with very small delay.</p>
<p>To implement subscriptions, you will need to introduce a pub-sub solution to your stack. Multiple technologies are available here, starting with dedicated solutions like Apache Kafka, RabbitMQ and ending with data stores supporting subscribing to updates like Redis and PostgreSQL. Each of those solutions offers different features and trade offs, making them useful for different use-cases.</p>
<p>Only requirement by Ariadne is that technology has Python implementation that supports <code>async</code> subscriber.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=simple-pub-sub-setup-with-broadcaster>Simple pub-sub setup with Broadcaster<a href=#simple-pub-sub-setup-with-broadcaster class=hash-link aria-label="Direct link to Simple pub-sub setup with Broadcaster" title="Direct link to Simple pub-sub setup with Broadcaster">​</a></h3>
<p><a href=https://github.com/encode/broadcaster target=_blank rel="noopener noreferrer">Broadcaster</a> is a simple pub-sub library that supports Redis, PostgreSQL and Apache Kafka as backends. It can be installed with <code>pip</code>:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-console codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">pip install broadcaster</span><br></span></code></pre></div></div>
<p>In our example we will use Redis server running on localhost at port 6379 for messaging. We instantiate <code>Broadcaster</code> with connection URL in our app:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">broadcast </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Broadcast</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"redis://localhost:6379"</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<p>We also need to run its <code>connect</code> and <code>disconnect</code> methods when our ASGI app starts or stops:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">app </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Starlette</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">on_startup</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">broadcast</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">connect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> on_shutdown</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">broadcast</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">disconnect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=publisher>Publisher<a href=#publisher class=hash-link aria-label="Direct link to Publisher" title="Direct link to Publisher">​</a></h3>
<p>We can publish our messages using the <code>publish</code> method:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> broadcast</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">publish</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">channel</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"chatroom"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> message</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"Hello world!"</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Note:</strong> Channels are a way to group publishers and subscribers together. Your system may use single channel or multiple ones, each for different feature.</p>
</blockquote>
<p>Where publishing code should live at? Simplest answer is <em>at the same place that events occur that you would like your users to subscribe to</em>. Here are few examples:</p>
<ul>
<li>In GraphQL mutations: <code>postComment</code> mutation could publish event to notify other clients on same page that new commend was posted.</li>
<li>In task queues: <code>process_video_file</code> Celery task could publish event with current progress on processing uploaded video file.</li>
<li>In regular views: your JSON API or standard HTTP form view can send an event that contact form was sent to notify customer service members on-line.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=subscriber>Subscriber<a href=#subscriber class=hash-link aria-label="Direct link to Subscriber" title="Direct link to Subscriber">​</a></h3>
<p>Unlike publishers, which can go anywhere, subscribers in GraphQL API's have single dedicated place: subscriptions <em>source</em>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token decorator annotation punctuation" style=color:#393A34>@subscription</span><span class="token decorator annotation punctuation" style=color:#393A34>.</span><span class="token decorator annotation punctuation" style=color:#393A34>source</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"chat"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>chat_generator</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>_</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> info</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> GraphQLResolveInfo</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token operator" style=color:#393A34>></span><span class="token plain"> AsyncGenerator</span><span class="token punctuation" style=color:#393A34>[</span><span class="token builtin">str</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>None</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>with</span><span class="token plain"> broadcast</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">subscribe</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">channel</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"chatroom"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> subscriber</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> message </span><span class="token keyword" style=color:#00009f>in</span><span class="token plain"> subscriber</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>yield</span><span class="token plain"> message</span><br></span></code></pre></div></div>
<p>In addition to that, generators can be used to filter which messages should and which shouldn't be sent further to the subscribers:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token decorator annotation punctuation" style=color:#393A34>@subscription</span><span class="token decorator annotation punctuation" style=color:#393A34>.</span><span class="token decorator annotation punctuation" style=color:#393A34>source</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"chat"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>chat_generator</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>_</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> info</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> GraphQLResolveInfo</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token operator" style=color:#393A34>></span><span class="token plain"> AsyncGenerator</span><span class="token punctuation" style=color:#393A34>[</span><span class="token builtin">str</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>None</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    swearwords </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> load_swearwords</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>with</span><span class="token plain"> broadcast</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">subscribe</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">channel</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"chatroom"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> subscriber</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> message </span><span class="token keyword" style=color:#00009f>in</span><span class="token plain"> subscriber</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>not</span><span class="token plain"> contains_swearwords</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">message</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> swearwords</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>yield</span><span class="token plain"> message</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=simple-chat-example>Simple chat example:<a href=#simple-chat-example class=hash-link aria-label="Direct link to Simple chat example:" title="Direct link to Simple chat example:">​</a></h3>
<p>Here's example implementing simple GraphQL chat with mutation for sending messages and subscription for receiving them:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> json</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> MutationType</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> SubscriptionType</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> make_executable_schema</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">asgi </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> GraphQL</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">asgi</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">handlers </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> GraphQLWSHandler</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> broadcaster </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> Broadcast</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> starlette</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">applications </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> Starlette</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">broadcast </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Broadcast</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"memory://"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">type_defs </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style=color:#e3116c>"""</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>  type Query {</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>    _unused: Boolean</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>  }</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=display:inline-block;color:#e3116c></span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>  type Message {</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>    sender: String</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>    message: String</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>  }</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=display:inline-block;color:#e3116c></span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>  type Mutation {</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>    send(sender: String!, message: String!): Boolean</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>  }</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=display:inline-block;color:#e3116c></span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>  type Subscription {</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>    message: Message</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>  }</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>"""</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">mutation </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> MutationType</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token decorator annotation punctuation" style=color:#393A34>@mutation</span><span class="token decorator annotation punctuation" style=color:#393A34>.</span><span class="token decorator annotation punctuation" style=color:#393A34>field</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"send"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>resolve_send</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">_</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>**</span><span class="token plain">message</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> broadcast</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">publish</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">channel</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"chatroom"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> message</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">json</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">dumps</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">message</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>True</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">subscription </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> SubscriptionType</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token decorator annotation punctuation" style=color:#393A34>@subscription</span><span class="token decorator annotation punctuation" style=color:#393A34>.</span><span class="token decorator annotation punctuation" style=color:#393A34>source</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"message"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>source_message</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">_</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> info</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>with</span><span class="token plain"> broadcast</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">subscribe</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">channel</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"chatroom"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> subscriber</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> event </span><span class="token keyword" style=color:#00009f>in</span><span class="token plain"> subscriber</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>yield</span><span class="token plain"> json</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">loads</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">event</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">message</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">schema </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> make_executable_schema</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">type_defs</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> mutation</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> subscription</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">graphql </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> GraphQL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    schema</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">schema</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    debug</span><span class="token operator" style=color:#393A34>=</span><span class="token boolean" style=color:#36acaa>True</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    websocket_handler</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">GraphQLWSHandler</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">app </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Starlette</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    debug</span><span class="token operator" style=color:#393A34>=</span><span class="token boolean" style=color:#36acaa>True</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    on_startup</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">broadcast</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">connect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    on_shutdown</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">broadcast</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">disconnect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">app</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">mount</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"/"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> graphql</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Note:</strong> We have expanded the code above into a repository with complete example, including GraphQL server, React.js client, Redis for messaging and Uvicorn HTTP server.</p>
<p>It can be found on our github: <a href=https://github.com/mirumee/ariadne-graphql-chat-example target=_blank rel="noopener noreferrer">Ariadne GraphQL Chat Example</a></p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=connection-params>Connection params<a href=#connection-params class=hash-link aria-label="Direct link to Connection params" title="Direct link to Connection params">​</a></h2>
<p>Because subscriptions in GraphQL are done over the websockets, you can't use custom HTTP headers to pass additional data from client to server. This makes it impossible to use <code>Authorization</code> header for authentication within subscriptions.</p>
<p>To work around this limitation, websocket clients include this data in initial message sent to the server as part of connection negotiation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=using-on_connect-to-access-connections-parameters>Using <code>on_connect</code> to access connection's parameters<a href=#using-on_connect-to-access-connections-parameters class=hash-link aria-label="Direct link to using-on_connect-to-access-connections-parameters" title="Direct link to using-on_connect-to-access-connections-parameters">​</a></h3>
<p>To access connection parameters, custom function needs to be implemented and passed to Ariadne's <code>on_connect</code> option:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">asgi</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">handlers </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> GraphQLWSHandler</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>on_connect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">websocket</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">graphql </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> GraphQL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    schema</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    websocket_handler</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">GraphQLWSHandler</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        on_connect</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">on_connect</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<p>This function is called exactly once: at the time when websocket connection is opened by the client. It's always called with two arguments: a <code>starlette.websockets.WebSocket</code> instance and a payload. It can be synchronous or asynchronous.</p>
<p>Please note that because <code>params</code> value is set by the client there are no guarantees on what type and concents this value will be. Due care needs to be taken here:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>on_connect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">websocket</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>not</span><span class="token plain"> </span><span class="token builtin">isinstance</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">params</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    token </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"token"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> token</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><br></span></code></pre></div></div>
<p>In order to make params available to the resolvers, they need to be passed through the <code>WebSocket.scope</code> dict to context factory:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>on_connect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">websocket</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>not</span><span class="token plain"> </span><span class="token builtin">isinstance</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">params</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        websocket</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">scope</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>"connection_params"</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># websocket.scope is a dict acting as a "bag"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic># stores data for the duration of connection</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    websocket</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">scope</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>"connection_params"</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"token"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"token"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>context_value</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">request_or_websocket</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> data</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    context </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> request</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">scope</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>"type"</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"websocket"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic># request is an instance of WebSocket</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        context</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">update</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">request</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">scope</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>"connection_params"</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>else</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        context</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>"token"</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> request</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">META</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"authorization"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> context</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">graphql </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> GraphQL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    schema</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    context_value</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">context_value</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    websocket_handler</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">GraphQLWSHandler</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        on_connect</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">on_connect</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=on_connect-vs-context_value><code>on_connect</code> vs <code>context_value</code><a href=#on_connect-vs-context_value class=hash-link aria-label="Direct link to on_connect-vs-context_value" title="Direct link to on_connect-vs-context_value">​</a></h3>
<p>There's important difference between <code>on_connect</code> and <code>context_value</code>:</p>
<p><code>on_connect</code> is called once, at the time of websocket connection negotiation between client and GraphQL server.</p>
<p><code>context_value</code> is called every time new subscription query is made by the client.</p>
<p>If your client has two separate UI components (eg. notification bell on the navbar and list of on-line users), and those components do GraphQL <code>subscribe</code> queries, <code>context_value</code> will be ran for each of those separately while <code>on_connect</code> will only be ran once.</p>
<blockquote>
<p><strong>Note:</strong> This behavior is true for most popular GraphQL client implementations (<code>gql</code> and Apollo-Client) but may not be true for some libraries.</p>
</blockquote>
<p>This can have implications for application performance. It may be preferable to cache data on <code>websocket.scope</code> instead of <code>info.context</code> to avoid repeated database reads for multiple subscriptions accessing same data. Or pre-load user object in <code>on_connect</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=refusing-websocket-connection>Refusing websocket connection<a href=#refusing-websocket-connection class=hash-link aria-label="Direct link to Refusing websocket connection" title="Direct link to Refusing websocket connection">​</a></h2>
<p>To refuse websocket connection from client, you can raise <code>ariadne.asgi.WebSocketConnectionError</code> from <code>on_connect</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>on_connect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">websocket</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>not</span><span class="token plain"> </span><span class="token builtin">isinstance</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">params</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>raise</span><span class="token plain"> WebSocketConnectionError</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Invalid payload"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    token </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"token"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>not</span><span class="token plain"> token</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>raise</span><span class="token plain"> WebSocketConnectionError</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Missing auth"</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<p>If you have control on client implementation as well, you can pass custom error payload instead of string:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>on_connect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">websocket</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>not</span><span class="token plain"> </span><span class="token builtin">isinstance</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">params</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>raise</span><span class="token plain"> WebSocketConnectionError</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"message"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Invalid payload"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"code"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"invalid_payload"</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    token </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"token"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>not</span><span class="token plain"> token</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>raise</span><span class="token plain"> WebSocketConnectionError</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"message"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Missing auth"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"code"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"auth"</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=on_operation-and-on_complete><code>on_operation</code> and <code>on_complete</code><a href=#on_operation-and-on_complete class=hash-link aria-label="Direct link to on_operation-and-on_complete" title="Direct link to on_operation-and-on_complete">​</a></h2>
<blockquote>
<p><strong>Warning:</strong> This feature is considered experimental. It was implemented for feature parity with older version of Apollo Server. Its final shape (or presence in future Ariadne releases) is snot decided yet. Generally you should try using <code>on_connect</code> and <code>on_disconnect</code> first before using those features.</p>
</blockquote>
<p><code>on_operation</code> and <code>on_complete</code> options allow you to run extra python code when client subscribes or unsubscribes from Subscription field within same WebSocket connection:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>on_operation</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">websocket</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> operation</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Operation</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>on_complete</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">websocket</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> operation</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Operation</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">graphql </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> GraphQL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">schema</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> on_operation</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">on_operation</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> on_complete</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">on_complete</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<p>First argument for those functions is <code>WebSocket</code> instance and second one is <code>Operation</code> dataclass storing data about current subscription:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token decorator annotation punctuation" style=color:#393A34>@dataclass</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>class</span><span class="token plain"> </span><span class="token class-name">Operation</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin">id</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Optional</span><span class="token punctuation" style=color:#393A34>[</span><span class="token builtin">str</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    generator</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> AsyncGenerator</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=on_disconnect><code>on_disconnect</code><a href=#on_disconnect class=hash-link aria-label="Direct link to on_disconnect" title="Direct link to on_disconnect">​</a></h2>
<p><code>on_disconnect</code> option can be set to callable function taking single argument, <code>WebSocket</code> instance, that should be ran after Ariadne closes the websocket connection:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">asgi </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> GraphQL</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">asgi</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">handlers </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> GraphQLWSHandler</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>on_connect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">websocket</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>not</span><span class="token plain"> </span><span class="token builtin">isinstance</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">params</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        websocket</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">scope</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>"connection_params"</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    chat_user </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> get_user_from_ws</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    chat_user</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">set_online</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    websocket</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">scope</span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>"chat_user"</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> chat_user</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>on_disconnect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">websocket</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    chat_user </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> websocket</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">scope</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"chat_user"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> chat_user</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        chat_user</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">set_offline</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">graphql </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> GraphQL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    schema</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    websocket_handler</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">GraphQLWSHandler</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        on_connect</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">on_connect</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        on_disconnect</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">on_disconnect</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=using-server-sent-events-protocol>Using Server-Sent Events Protocol<a href=#using-server-sent-events-protocol class=hash-link aria-label="Direct link to Using Server-Sent Events Protocol" title="Direct link to Using Server-Sent Events Protocol">​</a></h2>
<p>Instead of WebSockets, <a href=https://github.com/enisdenjo/graphql-sse/blob/master/PROTOCOL.md target=_blank rel="noopener noreferrer">Server-Sent Events (SSE)</a> can be used as a transmission protocol for subscriptions. This approach uses single, long-lived HTTP connection to push data to clients.</p>
<p>To enable subscriptions over Server-Sent Events, initialize the <code>ariadne.asgi.GraphQL</code> app with an <code>ariadne.contrib.sse.GraphQLHTTPSSEHandler</code> instance:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> asyncio</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> typing </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> AsyncGenerator</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> SubscriptionType</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> make_executable_schema</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> gql</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">asgi </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> GraphQL</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">contrib</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">sse </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> GraphQLHTTPSSEHandler</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">type_defs </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> gql</span><span class="token punctuation" style=color:#393A34>(</span><span class="token triple-quoted-string string" style=color:#e3116c>"""</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=display:inline-block;color:#e3116c></span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>    type Query {</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>        _empty: String</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>    }</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=display:inline-block;color:#e3116c></span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>    type Subscription {</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>        counter: Int!</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>    }</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=display:inline-block;color:#e3116c></span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>"""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">subscription </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> SubscriptionType</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token decorator annotation punctuation" style=color:#393A34>@subscription</span><span class="token decorator annotation punctuation" style=color:#393A34>.</span><span class="token decorator annotation punctuation" style=color:#393A34>field</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"counter"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>counter_resolver</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">count</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> info</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token operator" style=color:#393A34>></span><span class="token plain"> AsyncGenerator</span><span class="token punctuation" style=color:#393A34>[</span><span class="token builtin">int</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>None</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> count</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token decorator annotation punctuation" style=color:#393A34>@subscription</span><span class="token decorator annotation punctuation" style=color:#393A34>.</span><span class="token decorator annotation punctuation" style=color:#393A34>source</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"counter"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>async</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>counter_generator</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">obj</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> info</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Any</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token operator" style=color:#393A34>></span><span class="token plain"> AsyncGenerator</span><span class="token punctuation" style=color:#393A34>[</span><span class="token builtin">int</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>None</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> i </span><span class="token keyword" style=color:#00009f>in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>5</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>yield</span><span class="token plain"> i</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>await</span><span class="token plain"> asyncio</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">sleep</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">schema </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> make_executable_schema</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">type_defs</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">subscription</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">app </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> GraphQL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">schema</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> http_handler</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">GraphQLHTTPSSEHandler</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<p>Subscriptions can be consumed using the <a href=https://github.com/enisdenjo/graphql-sse/ target=_blank rel="noopener noreferrer">graphql-sse</a> JavaScript client library or any other compatible implementation.</p>
<blockquote>
<p>The <code>GraphQLHTTPSSEHandler</code> requires the ASGI server to work.</p>
<p>This handler only supports the <em>distinct connections</em> mode of the protocol due to Ariadne's stateless implementation.</p>
<p>If you are using a custom client implementation, make sure to add the <code>Accept: text/event-stream</code> header to the request as this is required to establish the Server-Sent Events connection.</p>
</blockquote></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/server/interfaces><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Interface types</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/server/dataloaders><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Dataloaders</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#subscription-protocols class="table-of-contents__link toc-highlight">Subscription protocols</a><ul><li><a href=#subscriptions-transport-ws class="table-of-contents__link toc-highlight"><code>subscriptions-transport-ws</code></a><li><a href=#graphql-ws class="table-of-contents__link toc-highlight"><code>graphql-ws</code></a></ul><li><a href=#defining-subscriptions class="table-of-contents__link toc-highlight">Defining subscriptions</a><li><a href=#writing-subscriptions class="table-of-contents__link toc-highlight">Writing subscriptions</a><li><a href=#publisher-consumer class="table-of-contents__link toc-highlight">Publisher-consumer</a><ul><li><a href=#simple-pub-sub-setup-with-broadcaster class="table-of-contents__link toc-highlight">Simple pub-sub setup with Broadcaster</a><li><a href=#publisher class="table-of-contents__link toc-highlight">Publisher</a><li><a href=#subscriber class="table-of-contents__link toc-highlight">Subscriber</a><li><a href=#simple-chat-example class="table-of-contents__link toc-highlight">Simple chat example:</a></ul><li><a href=#connection-params class="table-of-contents__link toc-highlight">Connection params</a><ul><li><a href=#using-on_connect-to-access-connections-parameters class="table-of-contents__link toc-highlight">Using <code>on_connect</code> to access connection's parameters</a><li><a href=#on_connect-vs-context_value class="table-of-contents__link toc-highlight"><code>on_connect</code> vs <code>context_value</code></a></ul><li><a href=#refusing-websocket-connection class="table-of-contents__link toc-highlight">Refusing websocket connection</a><li><a href=#on_operation-and-on_complete class="table-of-contents__link toc-highlight"><code>on_operation</code> and <code>on_complete</code></a><li><a href=#on_disconnect class="table-of-contents__link toc-highlight"><code>on_disconnect</code></a><li><a href=#using-server-sent-events-protocol class="table-of-contents__link toc-highlight">Using Server-Sent Events Protocol</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Ariadne ecosystem</div><ul class="footer__items clean-list"><li class=footer__item><a href="https://github.com/mirumee/ariadne?tab=readme-ov-file" target=_blank rel="noopener noreferrer" class=footer__link-item>Ariadne GraphQL Server<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href="https://github.com/mirumee/ariadne-codegen?tab=readme-ov-file" target=_blank rel="noopener noreferrer" class=footer__link-item>Ariadne GraphQL Client<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href="https://github.com/mirumee/ariadne-graphql-modules?tab=readme-ov-file" target=_blank rel="noopener noreferrer" class=footer__link-item>Ariadne GraphQL Modules<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href="https://github.com/mirumee/ariadne-auth?tab=readme-ov-file" target=_blank rel="noopener noreferrer" class=footer__link-item>Ariadne Auth<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href="https://github.com/mirumee/ariadne-lambda?tab=readme-ov-file" target=_blank rel="noopener noreferrer" class=footer__link-item>Ariadne AWS Lambda Extension<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Community</div><ul class="footer__items clean-list"><li class=footer__item><a href=mailto:ariadne@mirumee.com target=_blank rel="noopener noreferrer" class=footer__link-item>Email<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://x.com/AriadneGraphQL target=_blank rel="noopener noreferrer" class=footer__link-item>X<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>More</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://mirumee.com/blog target=_blank rel="noopener noreferrer" class=footer__link-item>Blog<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href="https://github.com/mirumee/Ariadne?tab=readme-ov-file#ariadne-ecosystem" target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2025  Mirumee Software.</div></div></div></footer></div>