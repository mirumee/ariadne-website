<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Ariadne Codegen 0.7 · Ariadne</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Ariadne Codegen 0.7 is now available!"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Ariadne Codegen 0.7 · Ariadne"/><meta property="og:type" content="website"/><meta property="og:url" content="https://ariadnegraphql.org/blog/2023/06/01/ariadne-codegen-0-7"/><meta property="og:description" content="Ariadne Codegen 0.7 is now available!"/><meta property="og:image" content="https://ariadnegraphql.org/img/share-image.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://ariadnegraphql.org/img/twitter-image.png"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"/><link rel="alternate" type="application/atom+xml" href="https://ariadnegraphql.org/blog/atom.xml" title="Ariadne Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://ariadnegraphql.org/blog/feed.xml" title="Ariadne Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-10159761-23', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo-horizontal.png" alt="Ariadne"/></a><a href="/versions"><h3>0.20</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="/docs/intro" target="_self">Docs</a></li><li class="siteNavGroupActive"><a href="/blog/" target="_self">Blog</a></li><li class=""><a href="/community" target="_self">Community</a></li><li class=""><a href="https://github.com/mirumee/ariadne" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Recent Posts</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Recent Posts</h3><ul class=""><li class="navListItem"><a class="navItem" href="/blog/2023/07/10/graphql-gathering">GraphQL Gathering EU in Berlin</a></li><li class="navListItem"><a class="navItem" href="/blog/2023/06/27/ariadne-0-20-1">Ariadne 0.20.1</a></li><li class="navListItem"><a class="navItem" href="/blog/2023/06/21/ariadne-0-20-0">Ariadne 0.20</a></li><li class="navListItem"><a class="navItem" href="/blog/2023/06/15/ariadne-graphql-proxy">Introducing Ariadne GraphQL Proxy</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/blog/2023/06/01/ariadne-codegen-0-7">Ariadne Codegen 0.7</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer postContainer blogContainer"><div class="wrapper"><div class="lonePost"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle"><a href="/blog/2023/06/01/ariadne-codegen-0-7">Ariadne Codegen 0.7</a></h1><p class="post-meta">June 1, 2023</p><div class="authorBlock"></div></header><div><span><p>Ariadne Codegen 0.7 is now available!</p>
<p>This release brings support for subscriptions, changes how fragments are represented in generated code, introduces the <code>ShorterResultsPlugin</code> plugin developed by our amazing community, and more features and fixes.</p>
<!--truncate-->
<h2><a class="anchor" aria-hidden="true" id="subscriptions"></a><a href="#subscriptions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Subscriptions</h2>
<p>Version <code>0.7</code> introduces support for subscriptions. We generate them as async generators, which means that we don't support subscriptions when the generated client is not async (<code>async_client</code> is set to <code>false</code>).</p>
<p>For example, given the following operation:</p>
<pre><code class="hljs css language-gql"><span class="hljs-attribute">subscription</span> GetUsersCounter {
    <span class="hljs-attribute">usersCounter</span>
}
</code></pre>
<p>Generated client will have following method:</p>
<pre><code class="hljs css language-py">    <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_users_counter</span><span class="hljs-params">(self)</span> -&gt; AsyncIterator[GetUsersCounter]:</span>
        query = gql(
            <span class="hljs-string">"""
            subscription GetUsersCounter {
              usersCounter
            }
            """</span>
        )
        variables: dict[str, object] = {}
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> self.execute_ws(query=query, variables=variables):
            <span class="hljs-keyword">yield</span> GetUsersCounter.parse_obj(data)
</code></pre>
<p>Our default async base client uses <a href="https://github.com/python-websockets/websockets">websockets</a> package and implements <a href="https://github.com/enisdenjo/graphql-ws/blob/master/PROTOCOL.md">graphql-transport-ws</a> subprotocol.</p>
<p>Required dependencies can be installed with pip:</p>
<pre><code class="hljs">$ pip <span class="hljs-keyword">install </span>ariadne-codegen[<span class="hljs-keyword">subscriptions]
</span></code></pre>
<h2><a class="anchor" aria-hidden="true" id="fragments"></a><a href="#fragments" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fragments</h2>
<p>In previous versions of Codegen fragments were &quot;unpacked&quot; in queries. For example, given the following operations:</p>
<pre><code class="hljs css language-gql">query <span class="hljs-class">GetA </span>{
    <span class="hljs-class">getTypeA </span>{
        ...FragmentA
    }
}

query <span class="hljs-class">ListA </span>{
    <span class="hljs-class">listTypeA </span>{
        ...FragmentA
    }
}

fragment FragmentA on <span class="hljs-class">TypeA </span>{
    id
    name
}
</code></pre>
<p>Generated <code>get_a.py</code> and <code>list_a.py</code> files had types looking like this:</p>
<pre><code class="hljs css language-py"><span class="hljs-comment"># get_a.py</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetA</span><span class="hljs-params">(BaseModel)</span>:</span>
    get_type_a: <span class="hljs-string">"GetAGetTypeA"</span> = Field(alias=<span class="hljs-string">"GetTypeA"</span>)


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetAGetTypeA</span><span class="hljs-params">(BaseModel)</span>:</span>
    id: str
    name: str
</code></pre>
<pre><code class="hljs css language-py"><span class="hljs-comment"># list_a.py</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListA</span><span class="hljs-params">(BaseModel)</span>:</span>
    list_type_a: List[<span class="hljs-string">"ListAListTypeA"</span>] = Field(alias=<span class="hljs-string">"ListTypeA"</span>)


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListAListTypeA</span><span class="hljs-params">(BaseModel)</span>:</span>
    id: str
    name: str
</code></pre>
<p>Both of these operations use the same <code>FragmentA</code> to represent <code>TypeA</code>, but generated models didn't reflect that.</p>
<p>To make working with fragments easier, in Ariadne Codegen 0.7 we are changing this behavior. Instead of unpacking fragments, we generate separate models from them and use those as mixins. The above operation will now result in 3 files being generated: <code>get_a.py</code>, <code>list_a.py</code>, and <code>fragments.py</code></p>
<pre><code class="hljs css language-py"><span class="hljs-comment"># get_a.py</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetA</span><span class="hljs-params">(BaseModel)</span>:</span>
    get_type_a: <span class="hljs-string">"GetAGetTypeA"</span> = Field(alias=<span class="hljs-string">"GetTypeA"</span>)


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetAGetTypeA</span><span class="hljs-params">(FragmentA)</span>:</span>
    <span class="hljs-keyword">pass</span>
</code></pre>
<pre><code class="hljs css language-py"><span class="hljs-comment"># list_a.py</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListA</span><span class="hljs-params">(BaseModel)</span>:</span>
    list_type_a: List[<span class="hljs-string">"ListAListTypeA"</span>] = Field(alias=<span class="hljs-string">"ListTypeA"</span>)


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListAListTypeA</span><span class="hljs-params">(FragmentA)</span>:</span>
    <span class="hljs-keyword">pass</span>
</code></pre>
<pre><code class="hljs css language-py"><span class="hljs-comment"># fragments.py</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FragmentA</span><span class="hljs-params">(BaseModel)</span>:</span>
    id: str
    name: str
</code></pre>
<p>With this change you can use fragments as reusable types in your Python logic using the client, eg. <code>def process_a(a: FragmentA)...</code>. New <code>fragments.py</code> consists of fragments collected from all parsed operations.</p>
<h3><a class="anchor" aria-hidden="true" id="unions-and-interfaces"></a><a href="#unions-and-interfaces" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Unions and Interfaces</h3>
<p>There is an exception from new fragments behaviour. If a fragment represents <code>Union</code> then we unpack it as before:</p>
<pre><code class="hljs css language-gql">query getAnimal {
    animal {
        ...AnimalData
    }
}

fragment AnimalData <span class="hljs-keyword">on</span> AnimalInterface {
    <span class="hljs-built_in">name</span>
    ... <span class="hljs-keyword">on</span> Dog {
        dogField
    }
    ... <span class="hljs-keyword">on</span> Cat {
        catField
    }
}
</code></pre>
<p>For the above fragment, this Python code will be generated:</p>
<pre><code class="hljs css language-py"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetAnimal</span><span class="hljs-params">(BaseModel)</span>:</span>
    animal: Union[
        <span class="hljs-string">"GetAnimalAnimalAnimalInterface"</span>, <span class="hljs-string">"GetAnimalAnimalDog"</span>, <span class="hljs-string">"GetAnimalAnimalCat"</span>
    ] = Field(discriminator=<span class="hljs-string">"typename__"</span>)


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetAnimalAnimalAnimalInterface</span><span class="hljs-params">(BaseModel)</span>:</span>
    typename__: Literal[<span class="hljs-string">"AnimalInterface"</span>, <span class="hljs-string">"Fish"</span>] = Field(alias=<span class="hljs-string">"__typename"</span>)
    name: str


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetAnimalAnimalDog</span><span class="hljs-params">(BaseModel)</span>:</span>
    typename__: Literal[<span class="hljs-string">"Dog"</span>] = Field(alias=<span class="hljs-string">"__typename"</span>)
    name: str
    dog_field: str = Field(alias=<span class="hljs-string">"dogField"</span>)


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetAnimalAnimalCat</span><span class="hljs-params">(BaseModel)</span>:</span>
    typename__: Literal[<span class="hljs-string">"Cat"</span>] = Field(alias=<span class="hljs-string">"__typename"</span>)
    name: str
    cat_field: str = Field(alias=<span class="hljs-string">"catField"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="shorterresultsplugin"></a><a href="#shorterresultsplugin" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>ShorterResultsPlugin</code></h2>
<p>In version 0.7 we are including <code>ShorterResultsPlugin</code> developed by our community. It can be used when operations have only one top-level field. For example, given the following operation:</p>
<pre><code class="hljs css language-gql"><span class="hljs-selector-tag">query</span> <span class="hljs-selector-tag">GetUser</span>($<span class="hljs-attribute">userId</span>: ID!) {
    <span class="hljs-selector-tag">user</span>(<span class="hljs-attribute">id</span>: $userId) {
        <span class="hljs-selector-tag">id</span>
    }
}
</code></pre>
<p>From this operation, the generated method looks like this:</p>
<pre><code class="hljs css language-py"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_user</span><span class="hljs-params">(self, user_id: str)</span> -&gt; GetUser:</span>
    query = gql(
        <span class="hljs-string">"""
        query GetUser($userId: ID!) {
            user(id: $userId) {
                id
            }
        }
        """</span>
    )
    variables: dict[str, object] = {<span class="hljs-string">"userId"</span>: user_id}
    response = <span class="hljs-keyword">await</span> self.execute(query=query, variables=variables)
    data = self.get_data(response)
    <span class="hljs-keyword">return</span> GetUser.parse_obj(data)
</code></pre>
<p>To get the value of <code>user</code>, we need to always get it by attribute, eg. <code>await get_user(&quot;1&quot;).user</code>. By using <code>ShorterResultsPlugin</code> our <code>get_user</code> returns the value of <code>user</code> directly.</p>
<pre><code class="hljs css language-toml">[tool.ariadne-codegen]
...
plugins = ["ariadne_codegen.contrib.shorter_results.ShorterResultsPlugin"]
</code></pre>
<pre><code class="hljs css language-py"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_user</span><span class="hljs-params">(self, user_id: str)</span> -&gt; GetUserUser:</span>
    ...
    <span class="hljs-keyword">return</span> GetUser.parse_obj(data).user

</code></pre>
<h2><a class="anchor" aria-hidden="true" id="discriminated-unions"></a><a href="#discriminated-unions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Discriminated unions</h2>
<p>To ensure that data is represented as a correct class we use pydantic's <a href="https://docs.pydantic.dev/dev-v2/usage/types/unions/#discriminated-unions-aka-tagged-unions">discriminated unions</a>. We add <code>__typename</code> to queries with unions and then use its value as <code>discriminator</code>. Let's take an example schema and query:</p>
<pre><code class="hljs css language-gql">type Query {
  animal: Animal!
}
<span class="hljs-built_in">
interface </span>Animal {
  name: String!
}
<span class="hljs-built_in">
type </span>Dog implements Animal {
  name: String!
  dogField: String!
}
<span class="hljs-built_in">
type </span>Cat implements Animal {
  name: String!
  catField: String!
}
<span class="hljs-built_in">
type </span>Fish implements Animal {
  name: String!
}
</code></pre>
<pre><code class="hljs css language-gql"><span class="hljs-attribute">query</span> GetAnimal {
    <span class="hljs-section">animal</span> {
        <span class="hljs-attribute">name</span>
        ... <span class="hljs-literal">on</span> Dog {
            <span class="hljs-attribute">dogField</span>
        }
        ... <span class="hljs-literal">on</span> Cat {
            <span class="hljs-attribute">catField</span>
        }
    }
}
</code></pre>
<p>From this query and operation, we generate following types:</p>
<pre><code class="hljs css language-py"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetAnimal</span><span class="hljs-params">(BaseModel)</span>:</span>
    animal: Union[
        <span class="hljs-string">"GetAnimalAnimalAnimal"</span>, <span class="hljs-string">"GetAnimalAnimalDog"</span>, <span class="hljs-string">"GetAnimalAnimalCat"</span>
    ] = Field(discriminator=<span class="hljs-string">"typename__"</span>)


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetAnimalAnimalAnimal</span><span class="hljs-params">(BaseModel)</span>:</span>
    typename__: Literal[<span class="hljs-string">"Animal"</span>, <span class="hljs-string">"Fish"</span>] = Field(alias=<span class="hljs-string">"__typename"</span>)
    name: str


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetAnimalAnimalDog</span><span class="hljs-params">(BaseModel)</span>:</span>
    typename__: Literal[<span class="hljs-string">"Dog"</span>] = Field(alias=<span class="hljs-string">"__typename"</span>)
    name: str
    dog_field: str = Field(alias=<span class="hljs-string">"dogField"</span>)


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GetAnimalAnimalCat</span><span class="hljs-params">(BaseModel)</span>:</span>
    typename__: Literal[<span class="hljs-string">"Cat"</span>] = Field(alias=<span class="hljs-string">"__typename"</span>)
    name: str
    cat_field: str = Field(alias=<span class="hljs-string">"catField"</span>)
</code></pre>
<p>We added <code>typename__</code> to this query, and by its value pydantic determines which model to choose.</p>
<h2><a class="anchor" aria-hidden="true" id="leading-underscores"></a><a href="#leading-underscores" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Leading underscores</h2>
<p>Ariadne Codegen 0.7 will remove leading <code>_</code> from field names. Fields with <code>_</code> are ignored by pydantic and it is impossible to save the value of such fields.</p>
<h2><a class="anchor" aria-hidden="true" id="removal-of-mixin-directive-from-operation-sent-to-a-server"></a><a href="#removal-of-mixin-directive-from-operation-sent-to-a-server" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Removal of <code>mixin</code> directive from operation sent to a server</h2>
<p>We support a custom <code>mixin</code> directive, which allows extending of generated types. In 0.7 we are removing it from the operation string included in generated client's methods. This directive is only used in the process of generation and caused servers to return errors because of an unknown directive.</p>
<h2><a class="anchor" aria-hidden="true" id="process_schema-plugin-hook"></a><a href="#process_schema-plugin-hook" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>process_schema</code> plugin hook</h2>
<p>Plugins can now define a <code>process_schema</code> hook to change schema before Codegen uses it for generation. From now on we allow invalid schemas to be parsed from files or URLs, and then we call this plugin hook. After <code>process_schema</code> is finished, the processed schema must pass <code>graphql.assert_valid_schema</code> validation.</p>
<p>For example, it can be used to add Apollo Federation directives definitions:</p>
<pre><code class="hljs css language-py"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyPlugin</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">process_schema</span><span class="hljs-params">(self, schema: GraphQLSchema)</span> -&gt; GraphQLSchema:</span>
        extends_directive_def = GraphQLDirective(...)
        schema.directives += (extends_directive_def, )

        <span class="hljs-keyword">return</span> schema
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="changelog"></a><a href="#changelog" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Changelog</h2>
<ul>
<li>Added support for subscriptions as async generators.</li>
<li>Changed how fragments are handled to generate separate module with fragments as mixins.</li>
<li>Fixed <code>ResultTypesGenerator</code> to trigger <code>generate_result_class</code> for each result model.</li>
<li>Changed processing of models fields to trim leading underscores.</li>
<li>Added <code>ShorterResultsPlugin</code> to standard plugins.</li>
<li>Fixed handling of inline fragments inside other fragments.</li>
<li>Changed generated unions to use pydantic's discriminated unions feature.</li>
<li>Replaced HTTPX's <code>json=</code> serializer for query payloads with pydantic's <code>pydantic_encoder</code>.</li>
<li>Removed <code>mixin</code> directive from operation string sent to server.</li>
<li>Fixed <code>ShorterResultsPlugin</code> that generated faulty code for discriminated unions.</li>
<li>Changed generator to ignore unused fragments which should be unpacked in queries.</li>
<li>Changed type hints for parse and serialize methods of scalars to <code>typing.Any</code>.</li>
<li>Added <code>process_schema</code> plugin hook.</li>
</ul>
</span></div></div><div class="blogSocialSection"><div class="blogSocialSectionItem"><a href="https://twitter.com/share" class="twitter-share-button" data-text="Ariadne Codegen 0.7" data-url="https://ariadnegraphql.org/blog/2023/06/01/ariadne-codegen-0-7" data-related="true" data-show-count="false">Tweet</a></div></div></div><div class="blog-recent"><a class="button" href="/blog">Recent Posts</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#subscriptions">Subscriptions</a></li><li><a href="#fragments">Fragments</a><ul class="toc-headings"><li><a href="#unions-and-interfaces">Unions and Interfaces</a></li></ul></li><li><a href="#shorterresultsplugin"><code>ShorterResultsPlugin</code></a></li><li><a href="#discriminated-unions">Discriminated unions</a></li><li><a href="#leading-underscores">Leading underscores</a></li><li><a href="#removal-of-mixin-directive-from-operation-sent-to-a-server">Removal of <code>mixin</code> directive from operation sent to a server</a></li><li><a href="#process_schema-plugin-hook"><code>process_schema</code> plugin hook</a></li><li><a href="#changelog">Changelog</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/icon.png" alt="Ariadne" height="107" width="128"/></a><div class="footerNavSpacer"></div><div class="footerNavTwoColumn"><h5>Documentation</h5><a href="/docs/intro.html">Introduction</a><a href="/docs/resolvers.html">Resolvers</a><a href="/docs/mutations.html">Mutations</a><a href="/docs/subscriptions.html">Subscriptions</a><a href="/docs/django-integration.html">Django integration</a><a href="/docs/flask-integration.html">Flask integration</a><a href="/docs/starlette-integration.html">Starlette integration</a><a href="/docs/other-integrations.html">Other integrations</a><a href="/docs/api-reference.html">API Reference</a><a href="/docs/logo.html">Logo</a></div><div><h5>Community</h5><a href="https://github.com/mirumee/ariadne/discussions/">Discuss</a><a href="https://github.com/mirumee/ariadne">GitHub</a><a class="github-button" href="https://github.com/mirumee/ariadne" data-icon="octicon-star" data-count-href="/mirumee/ariadne/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright"><a href="https://mirumee.com">Copyright © 2023 Mirumee Software</a><a href="https://mirumee.com">Ariadne is crafted with love by<img src="/img/mirumee.png" alt="Mirumee"/></a></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '507581234da84aebc8fe9918f530b714',
                indexName: 'ariadnegraphql',
                inputSelector: '#search_input_react'
              });
            </script></body></html>