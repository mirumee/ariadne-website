<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-server docs-version-0.17 docs-doc-page docs-doc-id-query-validators" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.8.1"><title data-rh=true>Query validators | Ariadne · Python GraphQL Schema-first</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://ariadnegraphql.org/img/docusaurus-social-card.jpg><meta data-rh=true name=twitter:image content=https://ariadnegraphql.org/img/docusaurus-social-card.jpg><meta data-rh=true property=og:url content=https://ariadnegraphql.org/server/0.17/query-validators><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=0.17><meta data-rh=true name=docusaurus_tag content=docs-server-0.17><meta data-rh=true name=docsearch:version content=0.17><meta data-rh=true name=docsearch:docusaurus_tag content=docs-server-0.17><meta data-rh=true property=og:title content="Query validators | Ariadne · Python GraphQL Schema-first"><meta data-rh=true name=description content='GraphQL uses query validators to check if Query AST is valid and can be executed. Every GraphQL server implements standard query validators. For example, there is an validator that tests if queried field exists on queried type, that makes query fail with "Cannot query field on type" error if it doesn&apos;t.'><meta data-rh=true property=og:description content='GraphQL uses query validators to check if Query AST is valid and can be executed. Every GraphQL server implements standard query validators. For example, there is an validator that tests if queried field exists on queried type, that makes query fail with "Cannot query field on type" error if it doesn&apos;t.'><link data-rh=true rel=icon href=/img/favicon.ico><link data-rh=true rel=canonical href=https://ariadnegraphql.org/server/0.17/query-validators><link data-rh=true rel=alternate href=https://ariadnegraphql.org/server/0.17/query-validators hreflang=en><link data-rh=true rel=alternate href=https://ariadnegraphql.org/server/0.17/query-validators hreflang=x-default><link data-rh=true rel=preconnect href=https://BYJBYPP90Q-dsn.algolia.net crossorigin=anonymous><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://ariadnegraphql.org/server/0.17/query-validators","name":"Query validators","position":1}]}</script><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="Ariadne · Python GraphQL Schema-first RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="Ariadne · Python GraphQL Schema-first Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-5LQNZWZVVS"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-5LQNZWZVVS",{anonymize_ip:!0})</script><link rel=search type=application/opensearchdescription+xml title="Ariadne · Python GraphQL Schema-first" href=/opensearch.xml><link rel=stylesheet href=/assets/css/styles.19ff8338.css><script src=/assets/js/runtime~main.2d57f2fb.js defer></script><script src=/assets/js/main.b315298b.js defer></script><body class=navigation-with-keyboard><svg xmlns=http://www.w3.org/2000/svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light",e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/img/logo-horizontal-sm.png><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/logo-horizontal-sm.png alt="Ariadne Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/img/logo-horizontal-sm.png alt="Ariadne Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/server/0.17/intro>Server</a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/server/0.17/query-validators>0.17</a><ul class=dropdown__menu><li><a class=dropdown__link href=/server/next/Docs/intro>Next</a><li><a class=dropdown__link href=/server/Docs/intro>0.29.0</a><li><a class=dropdown__link href=/server/0.25.1/Docs/intro>0.25.1</a><li><a class=dropdown__link href=/server/0.25/query-validators>0.25</a><li><a class=dropdown__link href=/server/0.24/query-validators>0.24</a><li><a class=dropdown__link href=/server/0.23/query-validators>0.23</a><li><a class=dropdown__link href=/server/0.22/query-validators>0.22</a><li><a class=dropdown__link href=/server/0.21/query-validators>0.21</a><li><a class=dropdown__link href=/server/0.20/query-validators>0.20</a><li><a class=dropdown__link href=/server/0.19/query-validators>0.19</a><li><a class=dropdown__link href=/server/0.18/query-validators>0.18</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/server/0.17/query-validators>0.17</a><li><a class=dropdown__link href=/server/0.16/query-validators>0.16</a><li><a class=dropdown__link href=/server/0.15/query-validators>0.15</a><li><a class=dropdown__link href=/server/0.14.0/query-validators>0.14.0</a><li><a class=dropdown__link href=/server/0.13.0/query-validators>0.13.0</a><li><a class=dropdown__link href=/server/0.12.0/query-validators>0.12.0</a><li><a class=dropdown__link href=/server/0.11.0/intro>0.11.0</a><li><a class=dropdown__link href=/server/0.10.0/intro>0.10.0</a><li><a class=dropdown__link href=/server/0.9.0/intro>0.9.0</a><li><a class=dropdown__link href=/server/0.8.0/intro>0.8.0</a><li><a class=dropdown__link href=/server/0.7.0/intro>0.7.0</a><li><a class=dropdown__link href=/server/0.6.0/intro>0.6.0</a><li><a class=dropdown__link href=/server/0.5.0/intro>0.5.0</a><li><a class=dropdown__link href=/server/0.4.0/intro>0.4.0</a></ul></div><a class="navbar__item navbar__link" href=/client/intro>Client</a><div class="navbar__item dropdown dropdown--hoverable"><a class=navbar__link aria-haspopup=true aria-expanded=false role=button href=/client/intro>0.15.4</a><ul class=dropdown__menu><li><a class=dropdown__link href=/client/next/intro>Next</a><li><a class=dropdown__link href=/client/intro>0.15.4</a><li><a class=dropdown__link href=/client/0.15.3/intro>0.15.3</a></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href=/blog>Blog</a><a class="navbar__item navbar__link" href=/community>Community</a><a href="https://github.com/mirumee/Ariadne?tab=readme-ov-file#ariadne-ecosystem" target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/0.17/intro>Docs</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/0.17/apollo-tracing>Monitoring</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/0.17/asgi>Servers</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/0.17/django-integration>Integrations</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/server/0.17/extensions>Extensions</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/0.17/extensions>Extension system</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/server/0.17/middleware>Middleware</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/server/0.17/query-validators>Query validators</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/0.17/api-reference>API reference</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/server/0.17/logo>Other</a></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role=alert><div>This is documentation for <!-- -->Ariadne · Python GraphQL Schema-first<!-- --> <b>0.17</b>, which is no longer actively maintained.</div><div class=margin-top--md>For up-to-date documentation, see the <b><a href=/server/Docs/intro>latest version</a></b> (<!-- -->0.29.0<!-- -->).</div></div><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Extensions</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Query validators</span></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 0.17</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Query validators</h1></header><p>GraphQL uses query validators to check if Query AST is valid and can be executed. Every GraphQL server implements standard query validators. For example, there is an validator that tests if queried field exists on queried type, that makes query fail with "Cannot query field on type" error if it doesn't.</p>
<p>Ariadne supports extending this server behaviour by including custom query validators.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=query-cost-validator>Query cost validator<a href=#query-cost-validator class=hash-link aria-label="Direct link to Query cost validator" title="Direct link to Query cost validator">​</a></h2>
<p>Query cost validation allows server owners to limit maximal allowed cost (or complexity) of GraphQL query. This forces malicious clients to run multiple HTTP requests which in turn allows server owners to limit or filter off their traffic through HTTP server settings.</p>
<p>First, query cost validator needs to be enabled on GraphQL server using <code>validation_rules</code> option:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">from ariadne.asgi import GraphQL</span><br></span><span class=token-line style=color:#393A34><span class="token plain">from ariadne.validation import cost_validator</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">schema = make_executable_schema() # make_executable_schema call with type definitions, resolvers, etc. ect.</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">graphql = Graphql(</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    schema,</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    validation_rules=[cost_validator(maximum_cost=5)]</span><br></span><span class=token-line style=color:#393A34><span class="token plain">)</span><br></span></code></pre></div></div>
<p>Next step is assigning costs values to schema fields. This can be done in Python or in the schema.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=setting-fields-costs-in-schema>Setting fields costs in schema<a href=#setting-fields-costs-in-schema class=hash-link aria-label="Direct link to Setting fields costs in schema" title="Direct link to Setting fields costs in schema">​</a></h3>
<p>To set fields costs in schema, first add <code>cost</code> directive definition to it:</p>
<div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-graphql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>directive</span><span class="token plain"> </span><span class="token directive function" style=color:#d73a49>@cost</span><span class="token punctuation" style=color:#393A34>(</span><span class="token attr-name" style=color:#00a4db>complexity</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token scalar">Int</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token attr-name" style=color:#00a4db>multipliers</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token scalar">String</span><span class="token operator" style=color:#393A34>!</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token attr-name" style=color:#00a4db>useMultipliers</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token scalar">Boolean</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>on</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>FIELD</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>FIELD_DEFINITION</span><br></span></code></pre></div></div>
<p>To make your schema future proof, directive's definition is available as import from Ariadne:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> ariadne</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">validation </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> cost_directive</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">schema </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> make_executable_schema</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">type_defs</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cost_directive</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<p>Now you can use this directive to assign costs to selected fields. For example, you can set cost of accessing <code>poster</code> field on <code>Post</code> type as <code>3</code> like this:</p>
<div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-graphql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>type</span><span class="token plain"> </span><span class="token class-name">Post</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token attr-name" style=color:#00a4db>id</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token scalar">ID</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token attr-name" style=color:#00a4db>name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token scalar">String</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token attr-name" style=color:#00a4db>poster</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token class-name">User</span><span class="token plain"> </span><span class="token directive function" style=color:#d73a49>@cost</span><span class="token punctuation" style=color:#393A34>(</span><span class="token attr-name" style=color:#00a4db>complexity</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<p>If you want to, you can make cost depend on the value of one or more of <code>Int</code> arguments that field accepts:</p>
<div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-graphql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>type</span><span class="token plain"> </span><span class="token class-name">Query</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token attr-name" style=color:#00a4db>news</span><span class="token punctuation" style=color:#393A34>(</span><span class="token attr-name" style=color:#00a4db>promoted</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token scalar">Int</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token attr-name" style=color:#00a4db>regular</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token scalar">Int</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token class-name">Post</span><span class="token plain"> </span><span class="token directive function" style=color:#d73a49>@cost</span><span class="token punctuation" style=color:#393A34>(</span><span class="token attr-name" style=color:#00a4db>complexity</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token attr-name" style=color:#00a4db>multipliers</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>"promoted"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"regular"</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<p>In the above example, final complexity will be multiplied by both <code>promoted</code> and <code>regular</code> values.</p>
<p>You can also use <code>useMultipliers</code> to remove query cost multiplication for specified field without removing <code>@cost</code> from it:</p>
<div class="language-graphql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-graphql codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>type</span><span class="token plain"> </span><span class="token class-name">Query</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token attr-name" style=color:#00a4db>news</span><span class="token punctuation" style=color:#393A34>(</span><span class="token attr-name" style=color:#00a4db>promoted</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token scalar">Int</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token class-name">Post</span><span class="token plain"> </span><span class="token directive function" style=color:#d73a49>@cost</span><span class="token punctuation" style=color:#393A34>(</span><span class="token attr-name" style=color:#00a4db>complexity</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token attr-name" style=color:#00a4db>multipliers</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>"promoted"</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token attr-name" style=color:#00a4db>useMultipliers</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>false</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=setting-fields-costs-in-python>Setting fields costs in Python<a href=#setting-fields-costs-in-python class=hash-link aria-label="Direct link to Setting fields costs in Python" title="Direct link to Setting fields costs in Python">​</a></h3>
<p>Fields costs can be set using Python dict passed as an option to <code>cost_validator</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">cost_map </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Query"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"news"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"complexity"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"multipliers"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token string" style=color:#e3116c>"promoted"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"regular"</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Post"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"poster"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"complexity"</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">graphql </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Graphql</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    type_defs</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    validation_rules</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">cost_validator</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">maximum_cost</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>5</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cost_map</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">cost_map</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=setting-default-field-cost-and-complexity>Setting default field cost and complexity<a href=#setting-default-field-cost-and-complexity class=hash-link aria-label="Direct link to Setting default field cost and complexity" title="Direct link to Setting default field cost and complexity">​</a></h3>
<p><code>cost_validator</code> supports two additional options to make configuring costs less verbose:</p>
<ul>
<li><code>default_complexity: int</code> - Default value for field <code>complexity</code> if its omitted from <code>@cost</code> or <code>price_map</code>. Defaults to <code>1</code>.</li>
<li><code>default_cost: int</code> - Default base value for field cost. Defaults to <code>0</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=configuring-cost_validator-dynamically>Configuring <code>cost_validator</code> dynamically<a href=#configuring-cost_validator-dynamically class=hash-link aria-label="Direct link to configuring-cost_validator-dynamically" title="Direct link to configuring-cost_validator-dynamically">​</a></h3>
<p>Because <code>validation_rules</code> option can be a <code>callable</code> (eg. function), it can be used to dynamically configure query costs validation based on GraphQL context or even parsed query itself:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>get_validation_rules</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">context_value</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> document</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> data</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    user </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> context_value</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"user"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> user</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> user</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">is_admin</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>None</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> user</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">is_high_ltv</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">cost_validator</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">maximum_cost</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>15</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">cost_validator</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">maximum_cost</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>5</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">graphql </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Graphql</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    schema</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    validation_rules</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">get_validation_rules</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=exposing-query-variables-to-cost_validator>Exposing query variables to <code>cost_validator</code><a href=#exposing-query-variables-to-cost_validator class=hash-link aria-label="Direct link to exposing-query-variables-to-cost_validator" title="Direct link to exposing-query-variables-to-cost_validator">​</a></h3>
<p>Cost validator will raise an error if query containing variables is made, but variable values are not made available to the validator. Use dynamic configuration to avoid this:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">type_defs </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> gql</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token triple-quoted-string string" style=color:#e3116c>"""</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>    type Query {</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>        hello(id: Int!): String!</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>    }</span><br></span><span class=token-line style=color:#393A34><span class="token triple-quoted-string string" style=color:#e3116c>    """</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>get_validation_rules</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">context_value</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> document</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> data</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">cost_validator</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">maximum_cost</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>5</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> variables</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">data</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">get</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"variables"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">schema </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> make_executable_schema</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">type_defs</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">graphql </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Graphql</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    schema</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    validation_rules</span><span class="token operator" style=color:#393A34>=</span><span class="token plain">get_validation_rules</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=complexity-of-lists-of-items>Complexity of lists of items<a href=#complexity-of-lists-of-items class=hash-link aria-label="Direct link to Complexity of lists of items" title="Direct link to Complexity of lists of items">​</a></h3>
<p>Query cost validation runs before query execution. This makes it impossible for field cost to depend on real number of returned children.</p>
<p>To deal with that you should use either multipliers, dynamic query cost configuration or make field's cost high enough in advance.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=implementing-custom-validator>Implementing custom validator<a href=#implementing-custom-validator class=hash-link aria-label="Direct link to Implementing custom validator" title="Direct link to Implementing custom validator">​</a></h2>
<p>All custom query validators should extend the <a href=https://github.com/graphql-python/graphql-core/blob/v3.0.5/src/graphql/validation/rules/__init__.py#L37 target=_blank rel="noopener noreferrer"><code>ValidationRule</code></a> base class importable from the <code>graphql.validation.rules</code> module.</p>
<p>Query validators are visitor classes. They are instantiated at the time of query validation with one required argument (<code>context: ASTValidationContext</code>).</p>
<p>In order to perform validation, your validator class should define one or more of <code>enter_*</code> and <code>leave_*</code> methods. For possible enter/leave items as well as details on function documentation, please see contents of the <a href=https://github.com/graphql-python/graphql-core/blob/v3.0.5/src/graphql/language/visitor.py target=_blank rel="noopener noreferrer"><code>visitor</code></a> module.</p>
<p>To make validation fail, you should call validator's <code>report_error</code> method with the instance of <code>GraphQLError</code> describing failure reason.</p>
<p>Here is an example query validator that visits field definitions in GraphQL query and fails query validation if any of those fields are introspection fields:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> graphql </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> GraphQLError</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> graphql</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">language </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> FieldNode</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>from</span><span class="token plain"> graphql</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">validation </span><span class="token keyword" style=color:#00009f>import</span><span class="token plain"> ValidationRule</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>is_introspection_field</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">field_name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> key</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">lower</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>in</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"__schema"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"__directive"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"__directivelocation"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"__type"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"__field"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"__inputvalue"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"__enumvalue"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"__typekind"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>class</span><span class="token plain"> </span><span class="token class-name">IntrospectionDisabledRule</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ValidationRule</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>def</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>enter_field</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">self</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> node</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> FieldNode</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">_args</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        field_name </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> node</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">name</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">value</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>not</span><span class="token plain"> is_introspection_key</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">field_name</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        self</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">report_error</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            GraphQLError</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string-interpolation string" style=color:#e3116c>f"Cannot query '</span><span class="token string-interpolation interpolation punctuation" style=color:#393A34>{</span><span class="token string-interpolation interpolation">field_name</span><span class="token string-interpolation interpolation punctuation" style=color:#393A34>}</span><span class="token string-interpolation string" style=color:#e3116c>': introspection is disabled."</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> node</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/server/0.17/middleware><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Middleware</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/server/0.17/api-reference><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>ariadne</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#query-cost-validator class="table-of-contents__link toc-highlight">Query cost validator</a><ul><li><a href=#setting-fields-costs-in-schema class="table-of-contents__link toc-highlight">Setting fields costs in schema</a><li><a href=#setting-fields-costs-in-python class="table-of-contents__link toc-highlight">Setting fields costs in Python</a><li><a href=#setting-default-field-cost-and-complexity class="table-of-contents__link toc-highlight">Setting default field cost and complexity</a><li><a href=#configuring-cost_validator-dynamically class="table-of-contents__link toc-highlight">Configuring <code>cost_validator</code> dynamically</a><li><a href=#exposing-query-variables-to-cost_validator class="table-of-contents__link toc-highlight">Exposing query variables to <code>cost_validator</code></a><li><a href=#complexity-of-lists-of-items class="table-of-contents__link toc-highlight">Complexity of lists of items</a></ul><li><a href=#implementing-custom-validator class="table-of-contents__link toc-highlight">Implementing custom validator</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Ariadne ecosystem</div><ul class="footer__items clean-list"><li class=footer__item><a href="https://github.com/mirumee/ariadne?tab=readme-ov-file" target=_blank rel="noopener noreferrer" class=footer__link-item>Ariadne GraphQL Server<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href="https://github.com/mirumee/ariadne-codegen?tab=readme-ov-file" target=_blank rel="noopener noreferrer" class=footer__link-item>Ariadne GraphQL Client<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href="https://github.com/mirumee/ariadne-graphql-modules?tab=readme-ov-file" target=_blank rel="noopener noreferrer" class=footer__link-item>Ariadne GraphQL Modules<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href="https://github.com/mirumee/ariadne-auth?tab=readme-ov-file" target=_blank rel="noopener noreferrer" class=footer__link-item>Ariadne Auth<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href="https://github.com/mirumee/ariadne-lambda?tab=readme-ov-file" target=_blank rel="noopener noreferrer" class=footer__link-item>Ariadne AWS Lambda Extension<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Community</div><ul class="footer__items clean-list"><li class=footer__item><a href=mailto:ariadne@mirumee.com target=_blank rel="noopener noreferrer" class=footer__link-item>Email<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://x.com/AriadneGraphQL target=_blank rel="noopener noreferrer" class=footer__link-item>X<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>More</div><ul class="footer__items clean-list"><li class=footer__item><a href="https://mirumee.com/blog?utm_source=ariadne_docs&utm_medium=referral" target=_blank rel="noopener noreferrer" class=footer__link-item>Blog<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href="https://github.com/mirumee/Ariadne?tab=readme-ov-file#ariadne-ecosystem" target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2026  Mirumee Software.</div></div></div></footer></div>